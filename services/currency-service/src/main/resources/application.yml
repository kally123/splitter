spring:
  application:
    name: currency-service
  
  r2dbc:
    url: r2dbc:postgresql://${POSTGRES_HOST:localhost}:${POSTGRES_PORT:5432}/${POSTGRES_DB:splitter_currency}
    username: ${POSTGRES_USER:splitter}
    password: ${POSTGRES_PASSWORD:splitter}
    pool:
      initial-size: 5
      max-size: 20
  
  flyway:
    enabled: true
    url: jdbc:postgresql://${POSTGRES_HOST:localhost}:${POSTGRES_PORT:5432}/${POSTGRES_DB:splitter_currency}
    user: ${POSTGRES_USER:splitter}
    password: ${POSTGRES_PASSWORD:splitter}
    locations: classpath:db/migration
  
  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}
  
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${JWT_ISSUER_URI:http://localhost:8081}
          jwk-set-uri: ${JWT_JWK_SET_URI:http://localhost:8081/.well-known/jwks.json}

server:
  port: ${SERVER_PORT:8087}

management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus,metrics
  endpoint:
    health:
      show-details: when_authorized
  metrics:
    tags:
      application: ${spring.application.name}

currency:
  provider:
    openexchangerates:
      api-key: ${OPENEXCHANGERATES_API_KEY:}
      base-url: https://openexchangerates.org/api
    cache:
      ttl-hours: 1

logging:
  level:
    com.splitter: DEBUG
    org.springframework.r2dbc: DEBUG
